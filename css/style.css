/* ==========================================================================
   1. GERAL, RESET E VARIÁVEIS DE TEMA
   ========================================================================== */
:root {
    --sidebar-width-expanded: 250px;
    --sidebar-width-collapsed: 85px;
    /* Paleta Light Mode (Padrão) */
    --cor-fundo: #F9F3FF; --cor-cards: #FFFFFF; --cor-texto-principal: #373737; --cor-texto-secundario: #555;
    --cor-destaque-1: #E87E55; --cor-destaque-2: #EA8652; --cor-cta: #BC68A1; --cor-cta-hover: #a35a8a;
    --cor-borda: #E0E0E0; --sombra-card: 0 4px 20px rgba(0, 0, 0, 0.07); --sombra-sidebar: 2px 0 10px rgba(0,0,0,0.05);
}
.dark-mode {
    /* Paleta Dark Mode */
    --cor-fundo: #2a2a2a; --cor-cards: #373737; --cor-texto-principal: #F9F3FF; --cor-texto-secundario: #ccc;
    --cor-borda: #444; --sombra-card: 0 4px 20px rgba(0, 0, 0, 0.2); --sombra-sidebar: 2px 0 10px rgba(0,0,0,0.2);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Poppins', sans-serif; background-color: var(--cor-fundo); color: var(--cor-texto-principal); transition: background-color 0.3s, color 0.3s; overflow-x: hidden; }
body:not(.dashboard-open) { display: flex; justify-content: center; align-items: center; min-height: 100vh; }
.hidden { display: none !important; }

/* ==========================================================================
   2. TELAS DE LOGIN E CADASTRO
   ========================================================================== */
.login-box { max-width: 400px; margin: 20px auto; background-color: var(--cor-cards); padding: 40px; border-radius: 12px; box-shadow: var(--sombra-card); text-align: center; border: 1px solid var(--cor-borda); }
.logo { max-width: 150px; margin-bottom: 20px; }
.login-box h1 { margin-bottom: 10px; color: var(--cor-destaque-1); }
.login-box p { margin-bottom: 30px; color: var(--cor-texto-secundario); }
.input-group { position: relative; text-align: left; margin-bottom: 20px; }
.input-group label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 0.9em; }
.input-group input { width: 100%; padding: 12px; border: 1px solid var(--cor-borda); border-radius: 8px; font-size: 1em; background-color: var(--cor-fundo); color: var(--cor-texto-principal); }
button[type="submit"] { width: 100%; padding: 15px; border: none; background-color: var(--cor-cta); color: white; font-size: 1.1em; font-weight: 600; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease; }
button[type="submit"]:hover { background-color: var(--cor-cta-hover); }
button[type="submit"]:disabled { background-color: #999; cursor: not-allowed; }
.error-feedback { color: #d32f2f; font-weight: 600; margin-top: 15px; height: 20px; }
.password-field { margin-bottom: 10px; }
.password-toggle-checkbox { display: flex; align-items: center; margin-top: 5px; font-size: 0.9em; color: var(--cor-texto-secundario); }
.password-toggle-checkbox input[type="checkbox"] { width: auto; margin-right: 8px; accent-color: var(--cor-cta); cursor: pointer; }
.password-toggle-checkbox label { margin-bottom: 0; cursor: pointer; font-weight: normal; }

/* ==========================================================================
   3. LAYOUT PRINCIPAL DO DASHBOARD
   ========================================================================== */
#dashboard-layout { display: flex; width: 100%; min-height: 100vh; }
#sidebar {
    width: var(--sidebar-width-expanded); background-color: var(--cor-cards);
    display: flex; flex-direction: column; position: fixed;
    top: 0; left: 0; height: 100vh; z-index: 1002;
    transition: width 0.3s ease-in-out; border-right: 1px solid var(--cor-borda);
}
#content-area {
    flex-grow: 1; padding: 20px;
    width: calc(100% - var(--sidebar-width-expanded));
    margin-left: var(--sidebar-width-expanded);
    transition: margin-left 0.3s ease-in-out, width 0.3s ease-in-out;
}

/* ==========================================================================
   4. SIDEBAR E COMPONENTES
   ========================================================================== */
/* --- Estrutura da Sidebar (AJUSTADO) --- */
.sidebar-header { text-align: center; padding-bottom: 20px; margin-bottom: 20px; border-bottom: 1px solid var(--cor-borda); transition: margin-bottom 0.3s ease; }
.sidebar-logo { max-width: 100px; margin-bottom: 10px; transition: max-width 0.3s ease, margin-bottom 0.3s ease; padding-top: 32px; }
.sidebar-title { color: var(--cor-destaque-1); font-size: 1.1em; transition: opacity 0.2s ease; }
.sidebar-nav { display: flex; flex-direction: column; flex-grow: 1; overflow: hidden; }
.sidebar-nav ul { list-style: none; padding: 0; }
.sidebar-nav .nav-main-links { flex-grow: 1; overflow-y: auto; }
.sidebar-nav li { margin-bottom: 2px; } 
.sidebar-nav a { 
    display: flex; align-items: center; gap: 15px; 
    padding: 10px 15px; 
    text-decoration: none; color: var(--cor-texto-secundario); border-radius: 8px; font-weight: 500; transition: background-color 0.3s, color 0.3s; 
    white-space: nowrap; overflow: hidden;
}
.sidebar-nav a:hover, .sidebar-nav a.active { background-color: var(--cor-cta); color: white; }
.sidebar-nav a i { font-size: 1.1em; width: 20px; text-align: center; }

/* --- Topbar e Menu Hambúrguer --- */
.topbar { background-color: var(--cor-cards); padding: 10px 25px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: var(--sombra-card); border: 1px solid var(--cor-borda); }
.menu-toggle {
    width: 24px; height: 18px; position: relative;
    background: none; border: none; cursor: pointer; display: none;
}
.menu-toggle span { display: block; position: absolute; height: 3px; width: 100%; background: var(--cor-texto-principal); border-radius: 3px; left: 0; transition: all 0.3s ease-in-out; }
.menu-toggle span:nth-child(1) { top: 0; }
.menu-toggle span:nth-child(2) { top: 7px; }
.menu-toggle span:nth-child(3) { top: 14px; }
.menu-toggle.active span:nth-child(1) { top: 7px; transform: rotate(135deg); }
.menu-toggle.active span:nth-child(2) { opacity: 0; left: -24px; }
.menu-toggle.active span:nth-child(3) { top: 7px; transform: rotate(-135deg); }
.topbar-profile { display: flex; align-items: center; gap: 15px; flex-grow: 1; }
.topbar-profile-photo { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; border: 3px solid var(--cor-destaque-2); }
.student-details { display: flex; flex-direction: column; align-items: flex-start; }
.student-name { font-size: 1.1em; font-weight: 600; color: var(--cor-texto-principal); }
.student-subdetails { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; font-size: 0.8em; color: var(--cor-texto-secundario); }
.student-subdetails .separator { color: var(--cor-borda); }
.theme-switch-wrapper { display: flex; align-items: center; gap: 10px; color: var(--cor-texto-secundario); }
.theme-switch { display: inline-block; height: 24px; position: relative; width: 50px; }
.theme-switch input { display: none; }
.slider { background-color: #ccc; position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; transition: .4s; border-radius: 34px; }
.slider:before { background-color: #fff; position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--cor-cta); }
input:checked + .slider:before { transform: translateX(26px); }

/* --- Conteúdo Principal e Layout de Cards --- */
.page-content { padding-top: 25px; }
.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}
.stat-card {
    background-color: var(--cor-cards); padding: 20px; border-radius: 12px;
    box-shadow: var(--sombra-card); border: 1px solid var(--cor-borda);
    display: flex; align-items: center; gap: 20px;
}
.stat-card .card-icon { font-size: 2.2em; color: var(--cor-cta); }
.stat-info h4 { font-size: 0.9em; color: var(--cor-texto-secundario); margin-bottom: 5px; font-weight: 500; }
.stat-info p { font-size: 1.8em; font-weight: 700; color: var(--cor-texto-principal); }
.card-full {
    background-color: var(--cor-cards); padding: 25px; border-radius: 12px;
    box-shadow: var(--sombra-card); border: 1px solid var(--cor-borda);
}
.recados-card { grid-column: 1 / -1; }
.card-full h4 { font-size: 1.2em; color: var(--cor-destaque-1); margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
.card-full p { color: var(--cor-texto-secundario); font-size: 1em; }
.performance-card { grid-column: 1 / -1; }
.performance-charts { display: grid; grid-template-columns: 1fr; gap: 25px; }
.chart-container h5 { text-align: center; margin-bottom: 15px; font-size: 1em; color: var(--cor-texto-secundario); }
.chart-wrapper { position: relative; height: 300px; width: 100%; }
.overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1001; opacity: 1; transition: opacity 0.3s; }
.overlay.hidden { opacity: 0; pointer-events: none; }

/* ==========================================================================
   5. LÓGICA DE COLAPSO DA SIDEBAR (DESKTOP)
   ========================================================================== */
body.sidebar-collapsed #sidebar { width: var(--sidebar-width-collapsed); }
body.sidebar-collapsed #content-area { margin-left: var(--sidebar-width-collapsed); width: calc(100% - var(--sidebar-width-collapsed)); }
body.sidebar-collapsed .sidebar-header { margin-bottom: 18px; padding-bottom: 18px; }
body.sidebar-collapsed .sidebar-title,
body.sidebar-collapsed .sidebar-nav span {
    opacity: 0; visibility: hidden; width: 0;
}
body.sidebar-collapsed .sidebar-nav a { justify-content: center; }
.sidebar-logo.logo-collapsed { display: none; }
body.sidebar-collapsed .sidebar-logo.logo-expanded { display: none; }
body.sidebar-collapsed .sidebar-logo.logo-collapsed { display: block; max-width: 45px; margin: 0 auto; }
.sidebar-toggle {
    position: absolute; top: 100px; right: -15px; transform: translateY(-50%);
    width: 30px; height: 30px; border-radius: 50%;
    background-color: var(--cor-cta); color: white; border: 2px solid var(--cor-fundo);
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    z-index: 1003; transition: transform 0.3s ease;
}
body.sidebar-collapsed .sidebar-toggle { transform: translateY(-50%) rotate(180deg); }

/* ==========================================================================
   6. RESPONSIVIDADE
   ========================================================================== */
@media (min-width: 576px) {
    .performance-charts { grid-template-columns: 1fr 1fr; }
}
@media (min-width: 992px) {
    .menu-toggle, .overlay { display: none !important; }
    #sidebar { transform: translateX(0); }
    .sidebar-toggle { display: flex; }
    .dashboard-grid { grid-template-columns: repeat(3, 1fr); }
    .recados-card { grid-column: 1 / -1; }
    .performance-card { grid-column: 1 / -1; }
}
@media (min-width: 1200px) {
    .recados-card { grid-column: auto; grid-row: span 1; }
    .performance-card { grid-column: span 2; }
}
@media (max-width: 992px) {
    #sidebar { transform: translateX(-100%); }
    #sidebar.active { transform: translateX(0); }
    #content-area { margin-left: 0; width: 100%; }
    .menu-toggle { display: block; }
    .sidebar-toggle { display: none; }
    body.sidebar-collapsed #sidebar { width: var(--sidebar-width-expanded); transform: translateX(-100%); }
    body.sidebar-collapsed #sidebar.active { transform: translateX(0); }
    body.sidebar-collapsed .sidebar-title,
    body.sidebar-collapsed .sidebar-nav span { opacity: 1; visibility: visible; width: auto; }
    body.sidebar-collapsed .sidebar-nav a { justify-content: flex-start; }
    body.sidebar-collapsed #content-area { margin-left: 0; width: 100%; }
}
@media (max-width: 768px) {
    body.dashboard-open { overflow: hidden; }
    .topbar { position: sticky; top: 10px; z-index: 999; margin: 0 10px; width: calc(100% - 20px); }
    #content-area { padding: 10px; }
    .page-content { margin-top: 10px; }
}
